---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "examples/Landmark_Classification_with_DeepFeatX.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: examples/Landmark_Classification_with_DeepFeatX.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/WittmannF/deepfeatx/blob/master/examples/Landmark_Classification_with_DeepFeatX.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install deepfeatx
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting deepfeatx
  Downloading https://files.pythonhosted.org/packages/11/64/2f83deecf5fbaea43ecad6fb695cab9c50dd6e1d07c524b0f2fb6600bd55/deepfeatx-0.0.2b1-py3-none-any.whl
Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (1.4.1)
Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (2.23.0)
Requirement already satisfied: tensorflow&gt;=1.14.0 in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (2.4.1)
Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (1.1.5)
Requirement already satisfied: seaborn in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (0.11.1)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (1.19.5)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (3.2.2)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (0.22.2.post1)
Requirement already satisfied: torchvision&gt;=0.2.2 in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (0.9.1+cu101)
Requirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from deepfeatx) (7.1.2)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;deepfeatx) (1.24.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;deepfeatx) (2020.12.5)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;deepfeatx) (3.0.4)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;deepfeatx) (2.10)
Requirement already satisfied: typing-extensions~=3.7.4 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (3.7.4.3)
Requirement already satisfied: protobuf&gt;=3.9.2 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (3.12.4)
Requirement already satisfied: tensorboard~=2.4 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (2.4.1)
Requirement already satisfied: keras-preprocessing~=1.1.2 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.1.2)
Requirement already satisfied: termcolor~=1.1.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.1.0)
Requirement already satisfied: astunparse~=1.6.3 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.6.3)
Requirement already satisfied: absl-py~=0.10 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (0.12.0)
Requirement already satisfied: wrapt~=1.12.1 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.12.1)
Requirement already satisfied: opt-einsum~=3.3.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (3.3.0)
Requirement already satisfied: grpcio~=1.32.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.32.0)
Requirement already satisfied: flatbuffers~=1.12.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.12)
Requirement already satisfied: gast==0.3.3 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (0.3.3)
Requirement already satisfied: tensorflow-estimator&lt;2.5.0,&gt;=2.4.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (2.4.0)
Requirement already satisfied: google-pasta~=0.2 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (0.2.0)
Requirement already satisfied: h5py~=2.10.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (2.10.0)
Requirement already satisfied: six~=1.15.0 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.15.0)
Requirement already satisfied: wheel~=0.35 in /usr/local/lib/python3.7/dist-packages (from tensorflow&gt;=1.14.0-&gt;deepfeatx) (0.36.2)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;deepfeatx) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;deepfeatx) (2.8.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;deepfeatx) (1.3.1)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;deepfeatx) (2.4.7)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;deepfeatx) (0.10.0)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;deepfeatx) (1.0.1)
Requirement already satisfied: torch==1.8.1 in /usr/local/lib/python3.7/dist-packages (from torchvision&gt;=0.2.2-&gt;deepfeatx) (1.8.1+cu101)
Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from protobuf&gt;=3.9.2-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (54.2.0)
Requirement already satisfied: google-auth-oauthlib&lt;0.5,&gt;=0.4.1 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (0.4.3)
Requirement already satisfied: tensorboard-plugin-wit&gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.8.0)
Requirement already satisfied: google-auth&lt;2,&gt;=1.6.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.28.0)
Requirement already satisfied: werkzeug&gt;=0.11.15 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.0.1)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.7/dist-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (3.3.4)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.7/dist-packages (from google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (1.3.0)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (0.2.8)
Requirement already satisfied: cachetools&lt;5.0,&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (4.2.1)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4; python_version &gt;= &#34;3.6&#34; in /usr/local/lib/python3.7/dist-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (4.7.2)
Requirement already satisfied: importlib-metadata; python_version &lt; &#34;3.8&#34; in /usr/local/lib/python3.7/dist-packages (from markdown&gt;=2.6.8-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (3.8.1)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.7/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (3.1.0)
Requirement already satisfied: pyasn1&lt;0.5.0,&gt;=0.4.6 in /usr/local/lib/python3.7/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (0.4.8)
Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version &lt; &#34;3.8&#34;-&gt;markdown&gt;=2.6.8-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=1.14.0-&gt;deepfeatx) (3.4.1)
Installing collected packages: deepfeatx
Successfully installed deepfeatx-0.0.2b1
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">deepfeatx.image</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">download_dataset</span><span class="p">(</span><span class="s1">&#39;https://udacity-dlnfd.s3-us-west-1.amazonaws.com/datasets/landmark_images.zip&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;landmark_images.zip&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Downloading Dataset...
Unzipping Dataset
Removing .zip file
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ife</span> <span class="o">=</span> <span class="n">ImageFeatureExtractor</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/resnet/resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5
94773248/94765736 [==============================] - 1s 0us/step
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">=</span><span class="n">ife</span><span class="o">.</span><span class="n">extract_features_from_directory</span><span class="p">(</span><span class="s1">&#39;/content/landmark_images/train&#39;</span><span class="p">,</span> <span class="n">include_classes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Found 4996 images belonging to 50 classes.
157/157 [==============================] - 41s 259ms/step
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="o">=</span><span class="n">ife</span><span class="o">.</span><span class="n">extract_features_from_directory</span><span class="p">(</span><span class="s1">&#39;/content/landmark_images/test&#39;</span><span class="p">,</span> <span class="n">include_classes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Found 1250 images belonging to 50 classes.
40/40 [==============================] - 10s 255ms/step
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>...</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
      <th>2021</th>
      <th>2022</th>
      <th>2023</th>
      <th>2024</th>
      <th>2025</th>
      <th>2026</th>
      <th>2027</th>
      <th>2028</th>
      <th>2029</th>
      <th>2030</th>
      <th>2031</th>
      <th>2032</th>
      <th>2033</th>
      <th>2034</th>
      <th>2035</th>
      <th>2036</th>
      <th>2037</th>
      <th>2038</th>
      <th>2039</th>
      <th>2040</th>
      <th>2041</th>
      <th>2042</th>
      <th>2043</th>
      <th>2044</th>
      <th>2045</th>
      <th>2046</th>
      <th>2047</th>
      <th>filepaths</th>
      <th>classes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.144473</td>
      <td>0.123102</td>
      <td>0.131711</td>
      <td>0.000000</td>
      <td>0.007521</td>
      <td>0.681572</td>
      <td>0.003118</td>
      <td>0.005768</td>
      <td>0.000000</td>
      <td>0.599635</td>
      <td>0.000403</td>
      <td>0.010173</td>
      <td>0.000941</td>
      <td>0.009182</td>
      <td>0.581831</td>
      <td>0.223279</td>
      <td>1.729023</td>
      <td>0.043978</td>
      <td>0.000000</td>
      <td>0.002313</td>
      <td>0.131089</td>
      <td>0.368686</td>
      <td>0.041157</td>
      <td>0.027625</td>
      <td>0.010595</td>
      <td>0.000000</td>
      <td>0.092005</td>
      <td>0.063416</td>
      <td>0.000000</td>
      <td>0.073335</td>
      <td>0.018608</td>
      <td>0.000000</td>
      <td>0.371507</td>
      <td>0.020624</td>
      <td>1.031506</td>
      <td>0.021580</td>
      <td>0.387918</td>
      <td>0.009284</td>
      <td>0.000000</td>
      <td>0.012937</td>
      <td>...</td>
      <td>0.024555</td>
      <td>0.041826</td>
      <td>0.019654</td>
      <td>0.000728</td>
      <td>0.006719</td>
      <td>0.000000</td>
      <td>0.544667</td>
      <td>0.008278</td>
      <td>0.124681</td>
      <td>1.839919</td>
      <td>0.000000</td>
      <td>0.007600</td>
      <td>0.000000</td>
      <td>0.003139</td>
      <td>0.487831</td>
      <td>0.009422</td>
      <td>0.016397</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.104711</td>
      <td>0.211086</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.047622</td>
      <td>0.000000</td>
      <td>0.018974</td>
      <td>0.010962</td>
      <td>0.064906</td>
      <td>0.0</td>
      <td>0.246748</td>
      <td>0.864391</td>
      <td>0.056831</td>
      <td>0.348137</td>
      <td>1.005095</td>
      <td>0.002894</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>/content/landmark_images/train/00.Haleakala_Na...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.051309</td>
      <td>0.853068</td>
      <td>1.045258</td>
      <td>0.000000</td>
      <td>0.119290</td>
      <td>0.365680</td>
      <td>0.038575</td>
      <td>0.315986</td>
      <td>0.020026</td>
      <td>0.222756</td>
      <td>0.110178</td>
      <td>0.051010</td>
      <td>0.275577</td>
      <td>0.013160</td>
      <td>0.604495</td>
      <td>0.532104</td>
      <td>4.745424</td>
      <td>0.002192</td>
      <td>0.291180</td>
      <td>0.117538</td>
      <td>0.034516</td>
      <td>0.116425</td>
      <td>0.360034</td>
      <td>0.185264</td>
      <td>0.197265</td>
      <td>0.013991</td>
      <td>0.359369</td>
      <td>0.114352</td>
      <td>0.031948</td>
      <td>0.625289</td>
      <td>0.422307</td>
      <td>0.306867</td>
      <td>1.645884</td>
      <td>0.426403</td>
      <td>0.002211</td>
      <td>0.830396</td>
      <td>1.446324</td>
      <td>0.000000</td>
      <td>0.180090</td>
      <td>0.434234</td>
      <td>...</td>
      <td>0.036309</td>
      <td>0.435226</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.129264</td>
      <td>0.195997</td>
      <td>7.162717</td>
      <td>0.007135</td>
      <td>0.064104</td>
      <td>2.091608</td>
      <td>0.364476</td>
      <td>0.997094</td>
      <td>0.069297</td>
      <td>0.000000</td>
      <td>2.886519</td>
      <td>0.200533</td>
      <td>0.000000</td>
      <td>0.066871</td>
      <td>0.006290</td>
      <td>0.157823</td>
      <td>0.071137</td>
      <td>0.008482</td>
      <td>0.319119</td>
      <td>0.535112</td>
      <td>0.073900</td>
      <td>0.004387</td>
      <td>0.531601</td>
      <td>0.006937</td>
      <td>0.0</td>
      <td>0.398494</td>
      <td>0.606953</td>
      <td>0.076465</td>
      <td>0.364600</td>
      <td>0.058309</td>
      <td>0.237696</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>/content/landmark_images/train/00.Haleakala_Na...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.024864</td>
      <td>0.181982</td>
      <td>0.441449</td>
      <td>0.042716</td>
      <td>0.075357</td>
      <td>0.011609</td>
      <td>0.421478</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.010368</td>
      <td>0.000000</td>
      <td>0.400369</td>
      <td>0.659238</td>
      <td>0.000000</td>
      <td>0.127548</td>
      <td>0.000000</td>
      <td>0.056632</td>
      <td>0.761068</td>
      <td>0.171233</td>
      <td>0.011245</td>
      <td>0.134383</td>
      <td>1.077651</td>
      <td>1.551231</td>
      <td>0.144508</td>
      <td>0.228294</td>
      <td>0.561290</td>
      <td>0.337509</td>
      <td>0.000000</td>
      <td>0.306071</td>
      <td>0.191113</td>
      <td>3.960692</td>
      <td>0.028523</td>
      <td>0.579900</td>
      <td>0.134433</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.263831</td>
      <td>0.000000</td>
      <td>0.141337</td>
      <td>0.754023</td>
      <td>...</td>
      <td>0.010314</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.090047</td>
      <td>0.000000</td>
      <td>6.593463</td>
      <td>0.000000</td>
      <td>0.019277</td>
      <td>0.566100</td>
      <td>0.003217</td>
      <td>1.399755</td>
      <td>0.013554</td>
      <td>0.005998</td>
      <td>1.756797</td>
      <td>0.168651</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.001577</td>
      <td>0.064882</td>
      <td>0.308789</td>
      <td>0.453748</td>
      <td>0.840887</td>
      <td>0.017527</td>
      <td>0.000000</td>
      <td>0.024009</td>
      <td>1.030970</td>
      <td>0.0</td>
      <td>0.004022</td>
      <td>0.014556</td>
      <td>0.000000</td>
      <td>0.010460</td>
      <td>1.463031</td>
      <td>0.000000</td>
      <td>0.141925</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>/content/landmark_images/train/00.Haleakala_Na...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.002672</td>
      <td>0.000000</td>
      <td>0.183501</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.278964</td>
      <td>0.244551</td>
      <td>0.007687</td>
      <td>1.023468</td>
      <td>0.383176</td>
      <td>0.040268</td>
      <td>0.137983</td>
      <td>0.008107</td>
      <td>0.020383</td>
      <td>0.011953</td>
      <td>0.288239</td>
      <td>0.979305</td>
      <td>0.102248</td>
      <td>0.467721</td>
      <td>0.000000</td>
      <td>0.473679</td>
      <td>0.158083</td>
      <td>0.236505</td>
      <td>0.064332</td>
      <td>0.506306</td>
      <td>1.358127</td>
      <td>0.000647</td>
      <td>0.000000</td>
      <td>0.017328</td>
      <td>4.818554</td>
      <td>0.338142</td>
      <td>0.496739</td>
      <td>0.157712</td>
      <td>0.404404</td>
      <td>0.009246</td>
      <td>0.352968</td>
      <td>0.000000</td>
      <td>0.684726</td>
      <td>0.200894</td>
      <td>...</td>
      <td>0.092775</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.043532</td>
      <td>0.573522</td>
      <td>7.222144</td>
      <td>0.053707</td>
      <td>0.041485</td>
      <td>0.180175</td>
      <td>0.109591</td>
      <td>0.005853</td>
      <td>0.045140</td>
      <td>0.333094</td>
      <td>9.537004</td>
      <td>0.139953</td>
      <td>0.000000</td>
      <td>0.092867</td>
      <td>0.006551</td>
      <td>0.235366</td>
      <td>0.890590</td>
      <td>0.383570</td>
      <td>0.304347</td>
      <td>0.000000</td>
      <td>0.431302</td>
      <td>0.123511</td>
      <td>0.309203</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.386091</td>
      <td>0.011272</td>
      <td>0.018598</td>
      <td>0.004779</td>
      <td>1.648630</td>
      <td>0.000000</td>
      <td>0.005909</td>
      <td>0.437527</td>
      <td>0.068694</td>
      <td>/content/landmark_images/train/00.Haleakala_Na...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.241694</td>
      <td>0.370684</td>
      <td>0.145281</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.564263</td>
      <td>0.232534</td>
      <td>0.184427</td>
      <td>0.089955</td>
      <td>0.123278</td>
      <td>0.244004</td>
      <td>0.625755</td>
      <td>0.225422</td>
      <td>0.000000</td>
      <td>0.121465</td>
      <td>0.111024</td>
      <td>1.022281</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.306522</td>
      <td>0.001790</td>
      <td>0.130664</td>
      <td>0.471943</td>
      <td>0.000000</td>
      <td>0.847071</td>
      <td>0.000000</td>
      <td>1.230086</td>
      <td>0.101357</td>
      <td>0.682177</td>
      <td>0.074763</td>
      <td>0.476144</td>
      <td>0.422238</td>
      <td>0.000000</td>
      <td>0.189124</td>
      <td>0.006272</td>
      <td>0.071484</td>
      <td>0.000000</td>
      <td>0.479576</td>
      <td>0.152067</td>
      <td>0.189220</td>
      <td>...</td>
      <td>0.324458</td>
      <td>0.080311</td>
      <td>0.005697</td>
      <td>1.058811</td>
      <td>0.323404</td>
      <td>1.319640</td>
      <td>0.944550</td>
      <td>0.018329</td>
      <td>0.000000</td>
      <td>0.431976</td>
      <td>0.356493</td>
      <td>0.499542</td>
      <td>0.019036</td>
      <td>0.048960</td>
      <td>3.004651</td>
      <td>0.186432</td>
      <td>0.304047</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.078827</td>
      <td>0.375502</td>
      <td>0.378271</td>
      <td>0.396171</td>
      <td>1.369546</td>
      <td>0.400577</td>
      <td>0.000000</td>
      <td>0.042660</td>
      <td>0.403769</td>
      <td>0.0</td>
      <td>0.325063</td>
      <td>0.276365</td>
      <td>0.000000</td>
      <td>0.031231</td>
      <td>1.042683</td>
      <td>0.832956</td>
      <td>0.054527</td>
      <td>0.343697</td>
      <td>0.000000</td>
      <td>/content/landmark_images/train/00.Haleakala_Na...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 2050 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;filepaths&#39;</span><span class="p">,</span> <span class="s1">&#39;classes&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;filepaths&#39;</span><span class="p">,</span> <span class="s1">&#39;classes&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">lr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8264</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">multi_class</span><span class="o">=</span><span class="s1">&#39;ovo&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9910066938775511</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;filepaths&#39;</span><span class="p">,</span> <span class="s1">&#39;classes&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;filepaths&#39;</span><span class="p">,</span> <span class="s1">&#39;classes&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.7368</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

